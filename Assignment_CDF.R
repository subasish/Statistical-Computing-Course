# CHAPTER 5
# Evaluating Standard Normal CDF

std.n.cdf <- function(x){
  	z <- max(c(x,-x))
  	check <- FALSE
  	if(x > 0) 
      check <- TRUE
  	prob = 0
  	if (z > 32.0) 
      return(1- prob)
      first <- exp(-0.5*z*z)
      phi <- first/sqrt(2*pi)
      if (z < 7.0)
      prob <- first*(p[8]*z + p[7]*z + p[6]*z + p[5]*z + p[4]*z+ p[3]*z + p[2]*z + p[1])/
	(q[9]*z + q[8]*z + q[7]*z + q[6]*z+ q[5]*z + q[4]*z + q[3]*z + q[2]*z + q[1])
      else
      prob = phi/(z + 1.0/(z + 2.0/(z + 3.0/(z + 4.0/
	+ (z + 5.0/(z + 6.0/(z + 7.0)))))))
 	if (check)
      prob = 1 - prob
      return(prob)
}
p= c(913.167442114755700, 1024.60809538333800, 580.109897562908800, 202.102090717023000,
46.0649519338751400, 6.81311678753268400, 0.6047379926867041, 0.02493381293151434)
q= c(1826.33488422951125, 3506.420597749092, 3044.77121163622200, 1566.104625828454,
523.596091947383490, 116.9795245776655, 17.1406995062577800, 1.515843318555982, 62500*1e-6)

std.n.cdf(1)

